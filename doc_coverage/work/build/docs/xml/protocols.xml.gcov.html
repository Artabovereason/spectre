<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - 5cafbabf779d8986d44a5fc730ab24cde7fafd16 - /work/build/docs/xml/protocols.xml</title>
  <link rel="stylesheet" type="text/css" href="../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title"> SpECTRE Documentation Coverage Report</td></tr>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../index.html">top level</a> - <a href="index.html">work/build/docs/xml</a> - protocols.xml</td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
             <td class="headerItem">Commit:</td>
             <td class="headerValue"><a target="_blank" href="https://github.com/sxs-collaboration/spectre/commit/5cafbabf779d8986d44a5fc730ab24cde7fafd16">5cafbabf779d8986d44a5fc730ab24cde7fafd16</a></td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2020-05-06 03:25:12</td>
            <td></td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<span class="lineNum">       1 </span><span class="lineCov">          1 : &lt;?xml version='1.0' encoding='UTF-8' standalone='no'?&gt;</span>
<span class="lineNum">       2 </span>            : &lt;doxygen xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;compound.xsd&quot; version=&quot;1.8.13&quot;&gt;
<span class="lineNum">       3 </span>            :   &lt;compounddef id=&quot;protocols&quot; kind=&quot;page&quot;&gt;
<span class="lineNum">       4 </span>            :     &lt;compoundname&gt;protocols&lt;/compoundname&gt;
<span class="lineNum">       5 </span>            :     &lt;title&gt;Protocols&lt;/title&gt;
<span class="lineNum">       6 </span>            :     &lt;detaileddescription&gt;
<span class="lineNum">       7 </span>            : &lt;sect1 id=&quot;protocols_1protocols_overview&quot;&gt;
<span class="lineNum">       8 </span>            : &lt;title&gt;Overview of protocols&lt;/title&gt;
<span class="lineNum">       9 </span>            : &lt;para&gt;Protocols are a concept we use in SpECTRE to define metaprogramming interfaces. A variation of this concept is built into many languages, so this is a quote from the &lt;ulink url=&quot;https://docs.swift.org/swift-book/LanguageGuide/Protocols.html&quot;&gt;Swift documentation&lt;/ulink&gt;:&lt;/para&gt;&lt;para&gt;&lt;blockquote&gt;&lt;para&gt;A protocol defines a blueprint of methods, properties, and other requirements that suit a particular task or piece of functionality. The protocol can then be adopted by a class, structure, or enumeration to provide an actual implementation of those requirements. Any type that satisfies the requirements of a protocol is said to conform to that protocol. &lt;/para&gt;&lt;/blockquote&gt;&lt;/para&gt;&lt;para&gt;You should define a protocol when you need a template parameter to conform to an interface. Protocols are implemented as unary type traits. Here is an example of a protocol that is adapted from the &lt;ulink url=&quot;https://docs.swift.org/swift-book/LanguageGuide/Protocols.html&quot;&gt;Swift documentation&lt;/ulink&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;namespace&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;protocols&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      10 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;namespace&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;namespacedetail&quot; kindref=&quot;compound&quot;&gt;detail&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      11 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__TypeTraitsGroup_1gaf5157dbd846dba6c52f75619eb95389f&quot; kindref=&quot;member&quot;&gt;CREATE_IS_CALLABLE&lt;/ref&gt;(name)&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      12 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;namespace&lt;sp/&gt;detail&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      13 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;/*!&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      14 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;sp/&gt;*&lt;sp/&gt;\brief&lt;sp/&gt;Has&lt;sp/&gt;a&lt;sp/&gt;name.&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      15 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;sp/&gt;*&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      16 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;sp/&gt;*&lt;sp/&gt;Requires&lt;sp/&gt;the&lt;sp/&gt;class&lt;sp/&gt;has&lt;sp/&gt;these&lt;sp/&gt;member&lt;sp/&gt;functions:&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      17 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;sp/&gt;*&lt;sp/&gt;-&lt;sp/&gt;`name`:&lt;sp/&gt;Returns&lt;sp/&gt;the&lt;sp/&gt;name&lt;sp/&gt;of&lt;sp/&gt;the&lt;sp/&gt;object&lt;sp/&gt;as&lt;sp/&gt;a&lt;sp/&gt;`std::string`.&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      18 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;&lt;sp/&gt;*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      19 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ConformingType&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      20 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Named&lt;sp/&gt;=&lt;sp/&gt;detail::is_name_callable_r&amp;lt;std::string,&lt;sp/&gt;ConformingType&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      21 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;namespace&lt;sp/&gt;protocols&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      22 </span>            : &lt;/programlisting&gt; The protocol defines an interface that any type that adopts it must implement. For example, the following class conforms to the protocol we just defined:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;class&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Person&lt;sp/&gt;:&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;public&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;structtt_1_1ConformsTo&quot; kindref=&quot;compound&quot;&gt;tt::ConformsTo&lt;/ref&gt;&amp;lt;protocols::Named&amp;gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      23 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;public&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;:&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      24 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Function&lt;sp/&gt;required&lt;sp/&gt;to&lt;sp/&gt;conform&lt;sp/&gt;to&lt;sp/&gt;the&lt;sp/&gt;protocol&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      25 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;&lt;sp/&gt;const&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;first_name_&lt;sp/&gt;+&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;+&lt;sp/&gt;last_name_;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      26 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      27 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;private&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;:&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      28 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Implementation&lt;sp/&gt;details&lt;sp/&gt;of&lt;sp/&gt;the&lt;sp/&gt;class&lt;sp/&gt;that&lt;sp/&gt;are&lt;sp/&gt;irrelevant&lt;sp/&gt;to&lt;sp/&gt;the&lt;sp/&gt;protocol&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      29 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;first_name_;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      30 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;last_name_;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      31 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      32 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;public&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;:&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      33 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;Person(&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;first_name,&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;last_name)&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      34 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;:&lt;sp/&gt;first_name_(&lt;ref refid=&quot;namespacestd&quot; kindref=&quot;compound&quot;&gt;std&lt;/ref&gt;::move(first_name)),&lt;sp/&gt;last_name_(&lt;ref refid=&quot;namespacestd&quot; kindref=&quot;compound&quot;&gt;std&lt;/ref&gt;::move(last_name))&lt;sp/&gt;{}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      35 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      36 </span>            : &lt;/programlisting&gt; The class indicates it conforms to the protocol by (publicly) inheriting from &lt;computeroutput&gt;&lt;ref refid=&quot;structtt_1_1ConformsTo&quot; kindref=&quot;compound&quot;&gt;tt::ConformsTo&lt;/ref&gt;&amp;lt;TheProtocol&amp;gt;&lt;/computeroutput&gt;.&lt;/para&gt;&lt;para&gt;Once you have defined a protocol, you can check if a class conforms to it using the &lt;computeroutput&gt;&lt;ref refid=&quot;group__ProtocolsGroup_1ga69cadf7e1af796b7b303137ffde2f8ad&quot; kindref=&quot;member&quot;&gt;tt::conforms_to&lt;/ref&gt;&lt;/computeroutput&gt; metafunction:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(tt::conforms_to_v&amp;lt;Person,&lt;sp/&gt;protocols::Named&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      37 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;The&lt;sp/&gt;class&lt;sp/&gt;does&lt;sp/&gt;not&lt;sp/&gt;conform&lt;sp/&gt;to&lt;sp/&gt;the&lt;sp/&gt;protocol.&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      38 </span>            : &lt;/programlisting&gt; Note that checking for protocol conformance is cheap, because the &lt;computeroutput&gt;&lt;ref refid=&quot;group__ProtocolsGroup_1ga69cadf7e1af796b7b303137ffde2f8ad&quot; kindref=&quot;member&quot;&gt;tt::conforms_to&lt;/ref&gt;&lt;/computeroutput&gt; metafunction only checks if the class &lt;emphasis&gt;indicates&lt;/emphasis&gt; it conforms to the protocol via the above inheritance. The rigorous test whether the class actually fullfills all of the protocol&amp;apos;s requirements is deferred to its unit tests (see &lt;ref refid=&quot;protocols_1protocols_testing_conformance&quot; kindref=&quot;member&quot;&gt;Protocol users: Testing protocol conformance&lt;/ref&gt;). Therefore you may freely use protocol conformance checks in your code.&lt;/para&gt;&lt;para&gt;This is how you can write code that relies on the interface defined by the protocol:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedThing&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      39 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;greet(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedThing&amp;amp;&lt;sp/&gt;named_thing)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      40 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Make&lt;sp/&gt;sure&lt;sp/&gt;the&lt;sp/&gt;template&lt;sp/&gt;parameter&lt;sp/&gt;conforms&lt;sp/&gt;to&lt;sp/&gt;the&lt;sp/&gt;protocol&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      41 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;static_assert(tt::conforms_to_v&amp;lt;NamedThing,&lt;sp/&gt;protocols::Named&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      42 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;NamedThing&lt;sp/&gt;must&lt;sp/&gt;be&lt;sp/&gt;Named.&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      43 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Now&lt;sp/&gt;we&lt;sp/&gt;can&lt;sp/&gt;rely&lt;sp/&gt;on&lt;sp/&gt;the&lt;sp/&gt;interface&lt;sp/&gt;that&lt;sp/&gt;the&lt;sp/&gt;protocol&lt;sp/&gt;defines&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      44 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Hello,&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;+&lt;sp/&gt;named_thing.name()&lt;sp/&gt;+&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;!&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      45 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      46 </span>            : &lt;/programlisting&gt; Checking for protocol conformance here makes it clear that we are expecting a template parameter that exposes the particular interface we have defined in the protocol. Therefore, the author of the protocol and of the code that uses it has explicitly defined (and documented!) the interface they expect. And the developer who consumes the protocol by writing classes that conform to it knows exactly what needs to be implemented.&lt;/para&gt;&lt;para&gt;Note that the &lt;computeroutput&gt;&lt;ref refid=&quot;group__ProtocolsGroup_1ga69cadf7e1af796b7b303137ffde2f8ad&quot; kindref=&quot;member&quot;&gt;tt::conforms_to&lt;/ref&gt;&lt;/computeroutput&gt; metafunction is SFINAE-friendly, so you can also use it like this:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Thing,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      47 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__UtilitiesGroup_1ga084d535585c18d4e80f8ec6052d341a3&quot; kindref=&quot;member&quot;&gt;Requires&amp;lt;not tt::conforms_to_v&amp;lt;Thing, protocols::Named&amp;gt;&lt;/ref&gt;&amp;gt;&lt;sp/&gt;=&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;nullptr&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      48 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;greet_anything(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Thing&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*anything*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      49 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Hello!&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      50 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      51 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedThing,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      52 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__UtilitiesGroup_1ga084d535585c18d4e80f8ec6052d341a3&quot; kindref=&quot;member&quot;&gt;Requires&amp;lt;tt::conforms_to_v&amp;lt;NamedThing, protocols::Named&amp;gt;&lt;/ref&gt;&amp;gt;&lt;sp/&gt;=&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;nullptr&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      53 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;greet_anything(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedThing&amp;amp;&lt;sp/&gt;named_thing)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      54 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;greet(named_thing);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      55 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      56 </span>            : &lt;/programlisting&gt; We typically define protocols in a file named &lt;computeroutput&gt;&lt;ref refid=&quot;Protocols_8hpp_source&quot; kindref=&quot;compound&quot;&gt;Protocols.hpp&lt;/ref&gt;&lt;/computeroutput&gt; and within a &lt;computeroutput&gt;protocols&lt;/computeroutput&gt; namespace, similar to how we write &lt;ref refid=&quot;group__DataBoxTagsGroup&quot; kindref=&quot;compound&quot;&gt;tags&lt;/ref&gt; in a &lt;computeroutput&gt;Tags.hpp&lt;/computeroutput&gt; file and within a &lt;computeroutput&gt;Tags&lt;/computeroutput&gt; namespace. The file should be placed in the directory associated with the code that depends on classes conforming to the protocols. For example, the protocol &lt;computeroutput&gt;Named&lt;/computeroutput&gt; in the example above would be placed in directory that also has the &lt;computeroutput&gt;greet&lt;/computeroutput&gt; function.&lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">      57 </span>            : &lt;sect1 id=&quot;protocols_1protocols_testing_conformance&quot;&gt;
<span class="lineNum">      58 </span>            : &lt;title&gt;Protocol users: Testing protocol conformance&lt;/title&gt;
<span class="lineNum">      59 </span>            : &lt;para&gt;Any class that indicates it conforms to the protocol must test that it actually does using the &lt;computeroutput&gt;test_protocol_conformance&lt;/computeroutput&gt; metafunction from &lt;computeroutput&gt;tests/Unit/ProtocolTestHelpers.hpp&lt;/computeroutput&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(test_protocol_conformance&amp;lt;Person,&lt;sp/&gt;protocols::Named&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      60 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Failed&lt;sp/&gt;testing&lt;sp/&gt;protocol&lt;sp/&gt;conformance&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      61 </span>            : &lt;/programlisting&gt; &lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">      62 </span>            : &lt;sect1 id=&quot;protocols_1protocols_author&quot;&gt;
<span class="lineNum">      63 </span>            : &lt;title&gt;Protocol authors: Protocols must be unary type traits&lt;/title&gt;
<span class="lineNum">      64 </span>            : &lt;para&gt;When you author a new protocol, keep in mind that protocols must be unary type traits. This means they take a single template parameter (typically named &lt;computeroutput&gt;ConformingType&lt;/computeroutput&gt;) and inherit from &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/types/integral_constant&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::true_type&lt;/ref&gt;&lt;/computeroutput&gt; or &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/types/integral_constant&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::false_type&lt;/ref&gt;&lt;/computeroutput&gt; depending on whether the &lt;computeroutput&gt;ConformingType&lt;/computeroutput&gt; fullfills the protocol&amp;apos;s requirements. Make sure to implement the protocol in a SFINAE-friendly way. You may find the macros in &lt;computeroutput&gt;&lt;ref refid=&quot;Utilities_2TypeTraits_8hpp_source&quot; kindref=&quot;compound&quot;&gt;Utilities/TypeTraits.hpp&lt;/ref&gt;&lt;/computeroutput&gt; useful. For example, we use &lt;computeroutput&gt;CREATE_IS_CALLABLE&lt;/computeroutput&gt; in the protocols above for testing the existence and return type of a member function.&lt;/para&gt;&lt;para&gt;Occasionally, you might be tempted to add additional template parameters to the protocol. In those situations, make the additional parameters part of your protocol instead. The reason for this guideline is that protocols will always be used as unary type traits when inheriting from &lt;computeroutput&gt;&lt;ref refid=&quot;structtt_1_1ConformsTo&quot; kindref=&quot;compound&quot;&gt;tt::ConformsTo&lt;/ref&gt;&amp;lt;Protocol&amp;gt;&lt;/computeroutput&gt;. Therefore, any template parameters of the protocol must also be template parameters of their conforming classes, which means the protocol can just check them.&lt;/para&gt;&lt;para&gt;For example, we could be tempted to follow this antipattern:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Don&amp;apos;t&lt;sp/&gt;do&lt;sp/&gt;this.&lt;sp/&gt;Protocols&lt;sp/&gt;should&lt;sp/&gt;be&lt;sp/&gt;_unary_&lt;sp/&gt;type&lt;sp/&gt;traits.&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      65 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ConformingType,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NameType&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      66 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedAntipattern&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      67 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Check&lt;sp/&gt;that&lt;sp/&gt;the&lt;sp/&gt;`name`&lt;sp/&gt;function&lt;sp/&gt;exists&lt;sp/&gt;_and_&lt;sp/&gt;its&lt;sp/&gt;return&lt;sp/&gt;type&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      68 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;detail::is_name_callable_r&amp;lt;NameType,&lt;sp/&gt;ConformingType&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      69 </span>            : &lt;/programlisting&gt; However, instead of making the protocol a non-unary template we should add a requirement to it:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Instead,&lt;sp/&gt;do&lt;sp/&gt;this.&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      70 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;namespace&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;namespacedetail&quot; kindref=&quot;compound&quot;&gt;detail&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      71 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__TypeTraitsGroup_1gae31399fb295155dea540c3e840dfa98d&quot; kindref=&quot;member&quot;&gt;CREATE_HAS_TYPE_ALIAS&lt;/ref&gt;(NameType)&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      72 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__TypeTraitsGroup_1ga2cce0a156dfe67bbf4f2b0b96b6239d9&quot; kindref=&quot;member&quot;&gt;CREATE_HAS_TYPE_ALIAS_V&lt;/ref&gt;(NameType)&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      73 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Lazily&lt;sp/&gt;evaluated&lt;sp/&gt;so&lt;sp/&gt;we&lt;sp/&gt;can&lt;sp/&gt;use&lt;sp/&gt;`ConformingType::NameType`&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      74 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ConformingType&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      75 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;IsNameCallableWithType&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      76 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;:&lt;sp/&gt;is_name_callable_r_t&amp;lt;typename&lt;sp/&gt;ConformingType::NameType,&lt;sp/&gt;ConformingType&amp;gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      77 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      78 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;namespace&lt;sp/&gt;detail&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      79 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ConformingType&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      80 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NamedWithType&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      81 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;First&lt;sp/&gt;check&lt;sp/&gt;the&lt;sp/&gt;class&lt;sp/&gt;has&lt;sp/&gt;a&lt;sp/&gt;`NameType`,&lt;sp/&gt;then&lt;sp/&gt;use&lt;sp/&gt;it&lt;sp/&gt;to&lt;sp/&gt;check&lt;sp/&gt;the&lt;sp/&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      82 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;type&lt;sp/&gt;of&lt;sp/&gt;the&lt;sp/&gt;`name`&lt;sp/&gt;function.&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      83 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/types/conditional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::conditional_t&amp;lt;detail::has_NameType_v&amp;lt;ConformingType&amp;gt;&lt;/ref&gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      84 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;detail::IsNameCallableWithType&amp;lt;ConformingType&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      85 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/types/integral_constant&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::false_type&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      86 </span>            : &lt;/programlisting&gt; Classes would need to specify the additional template parameters for any protocols they conform to anyway, if the protocols had any. So they might as well expose them:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;PersonWithNameType&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structtt_1_1ConformsTo&quot; kindref=&quot;compound&quot;&gt;tt::ConformsTo&lt;/ref&gt;&amp;lt;protocols::NamedWithType&amp;gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      87 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;NameType&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      88 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      89 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      90 </span>            : &lt;/programlisting&gt; This pattern also allows us to check for protocol conformance first and then add further checks about the types if we wanted to:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(tt::conforms_to_v&amp;lt;PersonWithNameType,&lt;sp/&gt;protocols::NamedWithType&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      91 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;The&lt;sp/&gt;class&lt;sp/&gt;does&lt;sp/&gt;not&lt;sp/&gt;conform&lt;sp/&gt;to&lt;sp/&gt;the&lt;sp/&gt;protocol.&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      92 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      93 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::is_same_v&amp;lt;typename&lt;sp/&gt;PersonWithNameType::NameType,&lt;sp/&gt;std::string&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      94 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;The&lt;sp/&gt;`NameType`&lt;sp/&gt;isn&amp;apos;t&lt;sp/&gt;a&lt;sp/&gt;`std::string`!&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      95 </span>            : &lt;/programlisting&gt; &lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">      96 </span>            : &lt;sect1 id=&quot;protocols_1protocols_testing&quot;&gt;
<span class="lineNum">      97 </span>            : &lt;title&gt;Protocol authors: Testing a protocol&lt;/title&gt;
<span class="lineNum">      98 </span>            : &lt;para&gt;We are currently testing protocol conformance as part of our unit tests, so that the global &lt;computeroutput&gt;&lt;ref refid=&quot;group__ProtocolsGroup_1ga69cadf7e1af796b7b303137ffde2f8ad&quot; kindref=&quot;member&quot;&gt;tt::conforms_to&lt;/ref&gt;&lt;/computeroutput&gt; convenience metafunction only needs to check if a type inherits off the protocol, but doesn&amp;apos;t need to check the protocol&amp;apos;s (possibly fairly expensive) implementation. This is primarily to keep compile times low, and may be reconsidered when transitioning to C++ &amp;quot;concepts&amp;quot;. Full protocol conformance is tested in the &lt;computeroutput&gt;test_protocol_conformance&lt;/computeroutput&gt; metafunction mentioned above.&lt;/para&gt;&lt;para&gt;To make sure their protocol functions correctly, protocol authors must test its implementation in a unit test (e.g. in a &lt;computeroutput&gt;Test_Protocols.hpp&lt;/computeroutput&gt;):&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(protocols::Named&amp;lt;Person&amp;gt;::value,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Failed&lt;sp/&gt;testing&lt;sp/&gt;the&lt;sp/&gt;protocol&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      99 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static_assert(not&lt;sp/&gt;protocols::Named&amp;lt;NotNamed&amp;gt;::value,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     100 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Failed&lt;sp/&gt;testing&lt;sp/&gt;the&lt;sp/&gt;protocol&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     101 </span>            : &lt;/programlisting&gt; They should make sure to test the implementation with classes that conform to the protocol, and others that don&amp;apos;t. This means the test will always include an example implementation of a class that conforms to the protocol, and the protocol author should add it to the documentation of the protocol through a Doxygen snippet. This gives users a convenient way to see how the author intends their interface to be implemented.&lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">     102 </span>            : &lt;sect1 id=&quot;protocols_1protocols_and_constraints&quot;&gt;
<span class="lineNum">     103 </span>            : &lt;title&gt;Protocols and C++20 &amp;quot;Constraints and concepts&amp;quot;&lt;/title&gt;
<span class="lineNum">     104 </span>            : &lt;para&gt;A feature related to protocols is in C++20 and goes under the name of &lt;ulink url=&quot;https://en.cppreference.com/w/cpp/language/constraints&quot;&gt;constraints and concepts&lt;/ulink&gt;. Every protocol defines a &lt;emphasis&gt;concept&lt;/emphasis&gt;, but it defers checking its requirements to the unit tests to save compile time. In other words, protocols provide a way to &lt;emphasis&gt;indicate&lt;/emphasis&gt; that a class fulfills a set of requirements, whereas C++20 constraints provide a way to &lt;emphasis&gt;check&lt;/emphasis&gt; that a class fulfills a set of requirements. Therefore, the two features complement each other. Once C++20 becomes available in SpECTRE we can either gradually convert our protocols to concepts and use them as constraints directly if we find the impact on compile time negligible, or we can add a concept that checks protocol conformance the same way that &lt;computeroutput&gt;&lt;ref refid=&quot;group__ProtocolsGroup_1ga4660233574869d3b757e06ecf3ec83ca&quot; kindref=&quot;member&quot;&gt;tt::conforms_to_v&lt;/ref&gt;&lt;/computeroutput&gt; currently does (i.e. by checking inheritance). &lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">     105 </span>            :     &lt;/detaileddescription&gt;
<span class="lineNum">     106 </span>            :   &lt;/compounddef&gt;
<span class="lineNum">     107 </span>            : &lt;/doxygen&gt;
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
